---

- name: Add extra repositories
  become: true
  apt_repository:
    repo: "{{ item.repo }}"
    state: present
  with_items:
    - "{{ default_repos }}"

- name: Add extra repositories keys
  become: true
  apt_key:
    url: "{{ item.key }}"
    state: present
  with_items:
    - "{{ default_repos_keys }}"

- name: Update system cache after added repositories
  become: true
  apt:
    update_cache: true
    cache_valid_time: 3600
  when:
    - apt_update is not defined


- apt: pkg=git,git-core,build-essential,libpq-dev,libreadline-dev,postfix,aptitude state=present
  become: true

- apt: pkg=python-pycurl,python-psycopg2 state=present
  become: true

- apt: pkg=libreadline6-dev,zlib1g-dev,libssl-dev,libyaml-dev,libsqlite3-dev,sqlite3,libxml2-dev,libxslt1-dev state=present
  become: true

- apt: pkg=autoconf,libgdbm-dev,libncurses5-dev,automake,libtool,bison,pkg-config,libffi-dev state=present
  become: true

- apt: pkg=locate,tree,ack-grep,htop,nmap,dlocate state=present
  become: true

- apt: upgrade=yes
  become: true

- apt: pkg=newrelic-sysmond update_cache=yes
  become: true

